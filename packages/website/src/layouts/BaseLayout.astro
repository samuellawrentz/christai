---
import "../styles/global.css";
import Navigation from "../components/sections/Navigation.astro";

export interface FAQSchema {
  question: string;
  answer: string;
}

export interface Props {
  title: string;
  description?: string;
  image?: string;
  url?: string;
  showHero?: boolean;
  faqSchema?: FAQSchema[];
}

const { title, description, image, url, showHero = false, faqSchema } = Astro.props;
const canonicalUrl = url || new URL(Astro.request.url).origin + Astro.url.pathname;
const siteUrl = new URL(Astro.request.url).origin;
const defaultDescription = "Chat with 14 biblical figures including Jesus, Moses, David, and Paul. AI-powered conversations for spiritual guidance and biblical wisdom.";
const defaultImage = "/og_image.png";

const figures = [
  "Jesus Christ", "Moses", "King David", "Paul", "Mary", "Abraham", "Peter",
  "Solomon", "Joshua", "Elijah", "Deborah", "Ruth", "Esther", "John the Baptist"
];

const webAppSchema = {
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "ChristianAI",
  "description": "Chat with 14 biblical figures using AI technology for spiritual guidance and biblical wisdom",
  "url": canonicalUrl,
  "applicationCategory": "LifestyleApplication",
  "operatingSystem": "Web Browser",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "audience": {
    "@type": "Audience",
    "audienceType": "Christians seeking spiritual guidance and biblical wisdom"
  },
  "featureList": figures.map(f => `AI conversations with ${f}`)
};

const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "ChristianAI",
  "url": siteUrl,
  "logo": `${siteUrl}/images/logo.png`,
  "description": "AI-powered conversations with biblical figures for spiritual growth and guidance"
};

const faqPageSchema = faqSchema ? {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": faqSchema.map(item => ({
    "@type": "Question",
    "name": item.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": item.answer
    }
  }))
} : null;
---

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
  <meta name="description" content={description || defaultDescription}>
  <meta name="keywords" content="Christian AI chat, biblical figures AI, Jesus AI, Moses AI, David AI, Paul AI, spiritual conversations, Christian technology, faith AI, biblical wisdom, religious AI, Bible study AI, faith journey" />
  <meta name="author" content="ChristianAI">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href={canonicalUrl} />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content={canonicalUrl}>
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description || defaultDescription}>
  <meta property="og:image" content={image || defaultImage}>
  <meta property="og:site_name" content="ChristianAI">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content={canonicalUrl}>
  <meta property="twitter:title" content={title}>
  <meta property="twitter:description" content={description || defaultDescription}>
  <meta property="twitter:image" content={image || defaultImage}>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Baskervville:ital,wght@0,400..700;1,400..700&family=Esteban&display=swap"
    rel="stylesheet"
  >

  <!-- Theme color -->
  <meta name="theme-color" content="#1a1612">

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/images/site.webmanifest">

  <!-- Structured Data: WebApplication -->
  <script type="application/ld+json" is:inline set:html={JSON.stringify(webAppSchema)} />

  <!-- Structured Data: Organization -->
  <script type="application/ld+json" is:inline set:html={JSON.stringify(organizationSchema)} />

  <!-- Structured Data: FAQPage -->
  {faqPageSchema && (
    <script type="application/ld+json" is:inline set:html={JSON.stringify(faqPageSchema)} />
  )}

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-F2FVEHRW7E"></script>
  <script is:inline>
    window.dataLayer = window.dataLayer || [];
    function gtag() { window.dataLayer.push(arguments); }
    gtag("js", new Date());
    gtag("config", "G-F2FVEHRW7E");
  </script>
</head>
<body>
  <Navigation />
  <slot />
</body>
</html>
